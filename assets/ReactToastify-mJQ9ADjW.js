import{b as j,r as i,_ as E,D as w,A as L,e as y}from"./index-BirL1DeV.js";import{v as T,D as q,u as Q}from"./InvoiceStatus-BUfEMt-8.js";function B(v,o){var f=j(o==null?void 0:o.client);T(v,q.Mutation);var p=i.useState({called:!1,loading:!1,client:f}),M=p[0],l=p[1],r=i.useRef({result:M,mutationId:0,isMounted:!0,client:f,mutation:v,options:o});Q(function(){Object.assign(r.current,{client:f,options:o,mutation:v})});var D=i.useCallback(function(t){t===void 0&&(t={});var b=r.current,k=b.options,A=b.mutation,h=E(E({},k),{mutation:A}),c=t.client||r.current.client;!r.current.result.loading&&!h.ignoreResults&&r.current.isMounted&&l(r.current.result={loading:!0,error:void 0,data:void 0,called:!0,client:c});var I=++r.current.mutationId,u=w(h,t);return c.mutate(u).then(function(e){var n,a,s=e.data,m=e.errors,d=m&&m.length>0?new L({graphQLErrors:m}):void 0,C=t.onError||((n=r.current.options)===null||n===void 0?void 0:n.onError);if(d&&C&&C(d,u),I===r.current.mutationId&&!u.ignoreResults){var _={called:!0,loading:!1,data:s,error:d,client:c};r.current.isMounted&&!y(r.current.result,_)&&l(r.current.result=_)}var g=t.onCompleted||((a=r.current.options)===null||a===void 0?void 0:a.onCompleted);return d||g==null||g(e.data,u),e}).catch(function(e){var n;if(I===r.current.mutationId&&r.current.isMounted){var a={loading:!1,error:e,data:void 0,called:!0,client:c};y(r.current.result,a)||l(r.current.result=a)}var s=t.onError||((n=r.current.options)===null||n===void 0?void 0:n.onError);if(s)return s(e,u),{data:void 0,errors:e};throw e})},[]),R=i.useCallback(function(){if(r.current.isMounted){var t={called:!1,loading:!1,client:r.current.client};Object.assign(r.current,{mutationId:0,result:t}),l(t)}},[]);return i.useEffect(function(){var t=r.current;return t.isMounted=!0,function(){t.isMounted=!1}},[]),[D,E({reset:R},M)]}export{B as u};
