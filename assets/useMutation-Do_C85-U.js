import{S as j,p as u,o as E,D as w,H as A,z as D}from"./index-vYH8fMO_.js";import{b as S,v as T,D as q}from"./invoice.queries-DdSBF33T.js";var z=j?u.useLayoutEffect:u.useEffect;function U(f,i){var v=S(i==null?void 0:i.client);T(f,q.Mutation);var p=u.useState({called:!1,loading:!1,client:v}),M=p[0],l=p[1],e=u.useRef({result:M,mutationId:0,isMounted:!0,client:v,mutation:f,options:i});z(function(){Object.assign(e.current,{client:v,options:i,mutation:f})});var R=u.useCallback(function(r){r===void 0&&(r={});var b=e.current,k=b.options,L=b.mutation,h=E(E({},k),{mutation:L}),d=r.client||e.current.client;!e.current.result.loading&&!h.ignoreResults&&e.current.isMounted&&l(e.current.result={loading:!0,error:void 0,data:void 0,called:!0,client:d});var I=++e.current.mutationId,o=w(h,r);return d.mutate(o).then(function(n){var t,a,c=n.data,m=n.errors,s=m&&m.length>0?new A({graphQLErrors:m}):void 0,C=r.onError||((t=e.current.options)===null||t===void 0?void 0:t.onError);if(s&&C&&C(s,o),I===e.current.mutationId&&!o.ignoreResults){var y={called:!0,loading:!1,data:c,error:s,client:d};e.current.isMounted&&!D(e.current.result,y)&&l(e.current.result=y)}var g=r.onCompleted||((a=e.current.options)===null||a===void 0?void 0:a.onCompleted);return s||g==null||g(n.data,o),n}).catch(function(n){var t;if(I===e.current.mutationId&&e.current.isMounted){var a={loading:!1,error:n,data:void 0,called:!0,client:d};D(e.current.result,a)||l(e.current.result=a)}var c=r.onError||((t=e.current.options)===null||t===void 0?void 0:t.onError);if(c)return c(n,o),{data:void 0,errors:n};throw n})},[]),_=u.useCallback(function(){if(e.current.isMounted){var r={called:!1,loading:!1,client:e.current.client};Object.assign(e.current,{mutationId:0,result:r}),l(r)}},[]);return u.useEffect(function(){var r=e.current;return r.isMounted=!0,function(){r.isMounted=!1}},[]),[R,E({reset:_},M)]}export{U as u};
