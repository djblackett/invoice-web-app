import{p as a,S as j,o as E,E as w,H as A,B as D}from"./index-DJHl-HbE.js";import{b as S,v as T,D as q}from"./invoice.queries-kXq_As9r.js";var B=j?a.useLayoutEffect:a.useEffect;function U(v,u){var f=S(u==null?void 0:u.client);T(v,q.Mutation);var p=a.useState({called:!1,loading:!1,client:f}),M=p[0],l=p[1],r=a.useRef({result:M,mutationId:0,isMounted:!0,client:f,mutation:v,options:u});B(function(){Object.assign(r.current,{client:f,options:u,mutation:v})});var R=a.useCallback(function(t){t===void 0&&(t={});var b=r.current,k=b.options,L=b.mutation,h=E(E({},k),{mutation:L}),c=t.client||r.current.client;!r.current.result.loading&&!h.ignoreResults&&r.current.isMounted&&l(r.current.result={loading:!0,error:void 0,data:void 0,called:!0,client:c});var I=++r.current.mutationId,i=w(h,t);return c.mutate(i).then(function(e){var n,o,s=e.data,m=e.errors,d=m&&m.length>0?new A({graphQLErrors:m}):void 0,C=t.onError||((n=r.current.options)===null||n===void 0?void 0:n.onError);if(d&&C&&C(d,i),I===r.current.mutationId&&!i.ignoreResults){var y={called:!0,loading:!1,data:s,error:d,client:c};r.current.isMounted&&!D(r.current.result,y)&&l(r.current.result=y)}var g=t.onCompleted||((o=r.current.options)===null||o===void 0?void 0:o.onCompleted);return d||g==null||g(e.data,i),e}).catch(function(e){var n;if(I===r.current.mutationId&&r.current.isMounted){var o={loading:!1,error:e,data:void 0,called:!0,client:c};D(r.current.result,o)||l(r.current.result=o)}var s=t.onError||((n=r.current.options)===null||n===void 0?void 0:n.onError);if(s)return s(e,i),{data:void 0,errors:e};throw e})},[]),_=a.useCallback(function(){if(r.current.isMounted){var t={called:!1,loading:!1,client:r.current.client};Object.assign(r.current,{mutationId:0,result:t}),l(t)}},[]);return a.useEffect(function(){var t=r.current;return t.isMounted=!0,function(){t.isMounted=!1}},[]),[R,E({reset:_},M)]}export{U as u};
